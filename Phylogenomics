159 (151 genbank, 8 refseq, these are duplicates, will need to remove) reference nematode genome assemblies were taken from NCBI genbank. Only included sequences at the scaffold level or above from the 2010 or newer.

# copy fna files from downloaded species folders and put in single flder for busco 
find ./* -type f -exec cp -n {} . \;

# To parralellize this and save time, I split the 159 genomes into 10 (15-16 genomes per folder) separate folders, then looped busco on each of them

for f1 in *.fna
do
busco -c 24 -i $f1 -l nematoda_odb10 --augustus -o ${f1%%.fna}"" -m geno
done
# takes a very long time to run busco on 151 genomes

# Next needed an outgroup
# Previously used out groups for neamtoda include kinorhyncha, priaplulida, tardigrada, nematomorpha
# there are no nematomorpha, or kinorhyncha, or nematomorpha genomes available
# there are 5 targigrade and 1 priapulida reference genomes available
# Going to try them as an outgroup
# They were downloaded and run against the nematoda_odb10 database, as above.

# My next task was to decide on a cutoff for busco quality. Some of the busco scores of the assemblies were low
# This paper "A Practical Guide to Design and Assess a Phylogenomic Study" indicates a cutoff of 80% could be valid
# real pain in the arse to filter over 150 busco folders tho
# Also. some papers indicate maximising taxon sampling is the most important factor here.
# Will assess how many busco scores top 80% and see if it is a devastating reduction in number of taxa in the dataset.

# I also wanted to decide on a dataset.


# parallelise modelfinder for IQTREE
# 
mkdir output
find *.fasta | parallel --bar 'iqtree -s {} -m MF -msub nuclear -pre output/{}'  
